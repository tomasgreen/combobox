(function(){"use strict";function t(t,i){!t||0===t.length&&t!=window||(t.length?Array.prototype.forEach.call(t,function(t,n){i(t)}):i(t))}function i(i,n,e,o){t(i,function(t){var i=n.split(" ");for(var s in i)t.addEventListener(i[s],e,o)})}function n(i,n){t(i,function(t){if(t.classList){var i=n.split(" ");for(var e in i)t.classList.add(i[e])}else t.className+=" "+n})}function e(i,n){t(i,function(t){if(t.classList){var i=n.split(" ");for(var e in i)t.classList.remove(i[e])}else t.className=t.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," ")})}function o(t,i){return t?t.classList?t.classList.contains(i):new RegExp("(^| )"+i+"( |$)","gi").test(t.className):void 0}function s(i,s){t(i,function(t){o(t,s)?e(t,s):n(t,s)})}function l(i,n,e){return void 0===e&&i&&void 0!==i.getAttribute?i.getAttribute(n):void t(i,function(t){t.setAttribute(n,e)})}function p(t,i,n,e){var o,s;i||(i={}),-1!==t.indexOf(".")&&(s=t.split("."),t=s[0],s.shift(),i["class"]=s.join(" ")),-1!==t.indexOf("#")&&(s=t.split("#"),t=s[0],i.id=s[1]),o=document.createElement(t);for(var l in i)o.setAttribute(l,i[l]);return n&&n.appendChild(o),e&&(o.innerHTML=e),o}function u(t){void 0===t&&(t={});var i={};for(var n in a)i[n]=void 0!==t[n]?t[n]:a[n];return i}function r(t){s(t.previousSibling,"combobox-option-focused")}function h(t){s(t.nextSibling,"combobox-option-focused")}var c={leftArrow:37,rightArrow:39,enter:13,backspace:8},a={},f=function(n,e){this.opt=u(n,e),this.el=n,this.el.style.display="none",this.container=p("div.combobox",null,this.el.parentNode),this.container.appendChild(this.el),this.inputContainer=p("div.combobox-input-container",null,this.container),this.tempEl=p("div.combobox-temp",null,this.container),t(n.querySelectorAll("option[selected]"),function(t){p("div.combobox-option",null,this.inputContainer,t.innerHTML)}.bind(this)),this.inputEl=p("input.combobox-input",null,this.inputContainer),this.tempEl.style.letterSpacing=this.inputEl.style.letterSpacing,this.tempEl.style.fontSize=this.inputEl.style.fontSize,this.tempEl.style.fontFamily=this.inputEl.style.fontFamily,this.tempEl.style.fontWeight=this.inputEl.style.fontWeight,this.tempEl.style.textTransform=this.inputEl.style.textTransform,i(this.container,"focus click",function(){this.inputEl.focus()}.bind(this)),l(this.inputContainer,"placeholder",l(this.el,"placeholder")),i(this.inputEl,"input",this.updateInputSize.bind(this)),i(this.inputEl,"keydown",this.onKeyDown.bind(this))};f.prototype.onKeyDown=function(t){switch(t.keyCode){case c.rightArrow:this.onKeyRightArrow(t);break;case c.leftArrow:this.onKeyLeftArrow(t);break;case c.backspace:this.onKeyBackspace(t);break;case c.enter:this.onKeyEnter(t)}this.togglePlaceholder()},f.prototype.onKeyEnter=function(t){if(0!==this.inputEl.value.length){var i=p("div.combobox-option",null,this.container,this.inputEl.value);this.inputEl.parentNode.insertBefore(i,this.inputEl),this.inputEl.value="",this.updateInputSize(),this.inputEl.focus()}},f.prototype.onKeyBackspace=function(t){0===this.inputEl.value.length&&(this.inputEl.previousSibling&&this.inputEl.parentNode.removeChild(this.inputEl.previousSibling),this.inputEl.focus())},f.prototype.onKeyLeftArrow=function(t){0===this.inputEl.value.length&&(t.shiftKey?r(this.inputEl):this.removeFocus(),this.inputEl.previousSibling&&this.inputEl.parentNode.insertBefore(this.inputEl,this.inputEl.previousSibling),this.inputEl.focus())},f.prototype.onKeyRightArrow=function(t){0===this.inputEl.value.length&&(t.shiftKey?h(this.inputEl):this.removeFocus(),this.inputEl.nextSibling?this.inputEl.parentNode.insertBefore(this.inputEl,this.inputEl.nextSibling.nextSibling):this.inputEl.parentNode.appendChild(this.inputEl),this.inputEl.focus())},f.prototype.updateInputSize=function(){this.tempEl.innerHTML=this.inputEl.value,this.inputEl.style.width=this.tempEl.offsetWidth+4+"px",this.togglePlaceholder()},f.prototype.togglePlaceholder=function(){1===this.inputEl.parentNode.childNodes.length&&0===this.inputEl.value.length?n(this.inputEl.parentNode,"combobox-placeholder"):e(this.inputEl.parentNode,"combobox-placeholder")},f.prototype.removeFocus=function(){e(this.inputEl.parentNode.querySelectorAll(".combobox-option-focused"),"combobox-option-focused")},this.ComboBox=function(t,i){var n=new f(t,i);return n},this.ComboBox.globals=a}).call(this);